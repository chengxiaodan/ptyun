!function(e){function t(r){if(o[r])return o[r].exports;var n=o[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";var r=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(r);n.default.namespace("PT.register"),PT.register=function(){this.valid=!0,this.time=null,this.http=n.default.http(),this.init(),this.bindEvent()},PT.register.prototype={init:function(){var e=this;e.active("register"),$("#register_step1").show(),$("#register_step2").hide(),$("#flash").on("click",function(){$("#code").attr("src",e.http.server+"?identity=imgcode&random="+Math.random()+"&method=verify.image.get")}),$("#nextStep1").click(function(){e.validate()&&e.sendCode()}),$("#regetCode").click(function(){e.sendCode()}),$("#nextStep2").on("click",function(){e.validRg()&&e.register()})},bindEvent:function(){var e=this,t=$("#username"),o=$("#codetext"),r=$("#getCode"),n=$("#password"),i=$("#secondPW");t.focus(function(){t.css("border","1px solid #dbdbdb"),$("#un_error").hide(),o.css("border","1px solid #dbdbdb"),$("#co_error").hide()}),t.blur(function(){e.validUser(t)}),o.focus(function(){o.css("border","1px solid #dbdbdb"),$("#co_error").hide()}),o.blur(function(){e.validCode(o)}),r.focus(function(){r.css("border","1px solid #dbdbdb")}),n.focus(function(){n.css("border","1px solid #dbdbdb")}),n.blur(function(){e.validPW(n)}),i.focus(function(){i.css("border","1px solid #dbdbdb")}),i.blur(function(){e.validRePw(i,n)})},validRg:function(){var e=this,t=!0,o=($("#getCode"),$("#password")),r=$("#secondPW");return function(){var r=e.validPW(o);t=t&&r}(),function(){var n=e.validRePw(r,o);t=t&&n}(),t},validRePw:function(e,t){var o=!0;return null==$.trim(e.val())||""==$.trim(e.val())||0==$.trim(e.val()).length?(o=!1,e.css("border","1px solid #f15556"),$("#spw_error").text("请再次输入登录密码"),$("#spw_error").show()):$.trim(e.val())!==$.trim(t.val())?(o=!1,e.css("border","1px solid #f15556"),$("#spw_error").text("请确认两次密码是否一致"),$("#spw_error").show()):(e.css("border","1px solid #dbdbdb"),o=!0),o},validPW:function(e){var t=!0;return null==e.val()||""==e.val()||0==e.val().length?(t=!1,e.css("border","1px solid #f15556"),$("#spw_error").text("请输入登录密码"),$("#spw_error").show()):n.default.fChkPassword($.trim(e.val()))?(e.css("border","1px solid #dbdbdb"),t=!0):(t=!1,e.css("border","1px solid #f15556"),$("#spw_error").text("密码长度应为8-16个字符的英文字母和数字"),$("#spw_error").show()),t},validUser:function(e){var t=this,o=!0;return null==e.val()||""==e.val()||0==e.val().length?(o=!1,e.css("border","1px solid #f15556"),$("#un_error").text("请输入手机号/邮箱地址"),$("#un_error").show()):n.default.fChkMail(e.val())||n.default.isphone(e.val())?o=t.asyncUnit():(o=!1,e.css("border","1px solid #f15556"),$("#un_error").text("手机号/邮箱输入格式错误"),$("#un_error").show()),o},asyncUnit:function(){var e=this,t=!0,o=$("#username"),r={},i="",a="";return n.default.isphone(o.val())?(r={mobile:o.val()},i="cloud.oauth.mobile.check",a=e.http.server+"?mobile="+r.mobile+"&method="+i):n.default.fChkMail(o.val())&&(r={email:o.val()},i="cloud.oauth.email.check",a=e.http.server+"?email="+r.email+"&method="+i),$.ajax({type:"get",url:a,headers:{method:i,appid:e.http.appid,sign:n.default.getSign(JSON.stringify(r),e.http.secretkey),timestramp:Date.parse(new Date)/1e3},cache:!1,async:!1,success:function(e){0==e.error_code?(o.css("border","1px solid #dbdbdb"),$("#un_error").hide(),t=!0):(o.css("border","1px solid #f15556"),$("#un_error").text(e.msg),$("#un_error").show(),t=!1)},error:function(e,t,o){}}),t},validCode:function(e){var t=this,o=!0;return null==e.val()||""==e.val()||void 0==e.val()?(e.css("border","1px solid #f15556"),$("#co_error").text("请输入识别码"),$("#co_error").show(),o=!1):o=t.checkCode(e),o},validate:function(){var e=this,t=!0,o=$("#username"),r=$("#codetext");return function(){var r=e.validUser(o);t=t&&r}(),function(){var o=e.validCode(r);t=t&&o}(),t},checkCode:function(e){var t=this,o={identity:"imgcode",code:e.val()},r=!0;return $.ajax({type:"post",url:t.http.server,headers:{method:"verify.image.check",appid:t.http.appid,sign:n.default.getSign(JSON.stringify(o),t.http.secretkey),timestramp:Date.parse(new Date)/1e3},data:JSON.stringify(o),dataType:"json",contentType:"application/json; charset=utf-8",cache:!1,async:!1,success:function(t){0==t.error_code?(e.css("border","1px solid #dbdbdb"),$("#co_error").hide(),r=!0):(e.css("border","1px solid #f15556"),$("#co_error").text("识别码错误"),$("#co_error").show(),r=!1)},error:function(e,t,o){}}),r},sendCode:function(){var e=this,t={addr:$("#username").val(),identity:"imgcode",code:$("#codetext").val()};$.ajax({type:"post",url:e.http.server,headers:{method:"cloud.oauth.verify.send",appid:e.http.appid,sign:n.default.getSign(JSON.stringify(t),e.http.secretkey),timestramp:Date.parse(new Date)/1e3},data:JSON.stringify(t),dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:function(){var e=$('<div class="loadingMask"></div>');$('<div class="loadEffect"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div>').appendTo(e),e.appendTo("body")},complete:function(){$(".loadingMask").remove()},cache:!1,success:function(e){0==e.error_code?($("#register_step1").hide(),$("#register_step2").show(),n.default.showBox("发送验证码成功")):($("#co_error").text(e.msg),$("#co_error").show())},error:function(e,t,o){}})},register:function(){var e=this,t=$("#username").val(),o=$("#password").val(),r=$("#secondPW").val(),i=$("#getCode").val(),a={},s="";n.default.isphone(t)?(a={mobile:t,password:o,repassword:r,code:i},s="cloud.oauth.mobile.register"):n.default.fChkMail(t)&&(a={email:t,password:o,repassword:r,code:i},s="cloud.oauth.email.register"),$.ajax({type:"post",url:e.http.server,headers:{method:s,appid:e.http.appid,sign:n.default.getSign(JSON.stringify(a),e.http.secretkey),timestramp:Date.parse(new Date)/1e3},data:JSON.stringify(a),dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:function(){var e=$('<div id="loadingMask" class="loadingMask"></div>');$('<div class="loadEffect"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div>').appendTo(e),e.appendTo("body")},complete:function(){$(".loadingMask").remove()},cache:!1,success:function(t){0==t.error_code?($("#spw_error").hide(),e.active("rg_success"),e.timer()):($("#spw_error").text(t.msg),$("#spw_error").show())},error:function(e,t,o){}})},timer:function(){var e=this,t=5;e.time=setInterval(function(){t--,0==t?(window.location.href="login.html",clearInterval(e.time)):$(".timer").text(t+"")},1e3)},active:function(e){var t=["register","rg_success"];$.each(t,function(o,r){e==r&&($("#"+r).show(),$.each(t,function(e,t){t!==r&&$("#"+t).hide()}))})}},$(document).ready(function(){new PT.register})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={http:function(){return{server:"https://api-open.putao.com/",appid:"1018043273668494336",secretkey:"07E13AFF126A4CAFBE58171AAB1CEE51"}},getSign:function(e,t){return hex_sha1(hex_md5(e).toLowerCase()+t).toLowerCase()},namespace:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var r,n,i,a,s,c,d,l,p;for(r=t,l=r.length,c=0;c<l;c++)for(s=r[c].split("."),a=window[s[0]]=window[s[0]]||{},i=s.slice(1),p=i.length,d=0;d<p;d++)n=i[d],a=a[n]=a[n]||{}},isphone:function(e){return/^1[0-9]{10}$/.test(e)},fChkMail:function(e){return/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,5}$/.test(e)},fChkPassword:function(e){return/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/.test(e)},dateFormat:function(e){var t=e.getFullYear()+"/";return e.getMonth()+1<10&&(t+="0"),t+=e.getMonth()+1+"/",e.getDate()<10&&(t+="0"),t+=e.getDate()+" ",e.getHours()<10&&(t+="0"),t+=e.getHours()+":",e.getMinutes()<10&&(t+="0"),t+=e.getMinutes()},goEail:function(e,t){var o=document.getElementById(t),r=e.split("@")[1];r=r.toLowerCase();var n={"qq.com":"http://mail.qq.com","gmail.com":"http://mail.google.com","sina.com":"http://mail.sina.com.cn","163.com":"http://mail.163.com","126.com":"http://mail.126.com","yeah.net":"http://www.yeah.net/","sohu.com":"http://mail.sohu.com/","tom.com":"http://mail.tom.com/","sogou.com":"http://mail.sogou.com/","139.com":"http://mail.10086.cn/","hotmail.com":"http://www.hotmail.com","live.com":"http://login.live.com/","live.cn":"http://login.live.cn/","live.com.cn":"http://login.live.com.cn","189.com":"http://webmail16.189.cn/webmail/","yahoo.com.cn":"http://mail.cn.yahoo.com/","yahoo.cn":"http://mail.cn.yahoo.com/","eyou.com":"http://www.eyou.com/","21cn.com":"http://mail.21cn.com/","188.com":"http://www.188.com/","foxmail.com":"http://www.foxmail.com"};for(var i in n)o.href=n[r]?n[r]:"http://mail."+n[r]},progress:function(e,t){var o=document.getElementById(e);100==t?$("#"+e).hide():$("#"+e).show();var r=o.width/2,n=o.height/2,t=t;if(o.getContext){var i=o.getContext("2d");i.beginPath(),i.moveTo(r,n),i.arc(r,n,60,0,2*Math.PI,!1),i.closePath(),i.fillStyle="#f3f3f3",i.fill(),i.beginPath(),i.moveTo(r,n),i.lineWidth=10,i.arc(r,n,60,1.5*Math.PI,1.5*Math.PI-2*Math.PI*t/100,!0),i.closePath(),i.fillStyle="#8C61DA",i.fill(),i.beginPath(),i.moveTo(r,n),i.arc(r,n,54.4,0,2*Math.PI,!0),i.closePath(),i.fillStyle="#ffffff",i.fill(),i.font="bold 9pt Arial",i.fillStyle="#8C61DA",i.textAlign="center",i.textBaseline="middle",i.moveTo(r,n),i.fillText(t+"%",r,n)}},getUrlParameter:function(e){var t,o,r,n=window.location.search.substring(1);if(n)for(t=n.split("&"),o=0;o<t.length;o++)if(r=t[o].split("="),r[0]===e)return r[1]},setCookie:function(e,t,r){var n=o.getsec(r),i=new Date;i.setTime(i.getTime()+1*n),document.cookie=e+"="+escape(t)+";expires="+i.toGMTString()},getsec:function(e){var t=1*e.substring(1,e.length),o=e.substring(0,1);return"s"==o?1e3*t:"h"==o?60*t*60*1e3:"d"==o?24*t*60*60*1e3:void 0},getCookie:function(e){var t,o=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(o))?unescape(t[2]):null},delCookie:function(e){var t=new Date;t.setTime(t.getTime()-1);var o=getCookie(e);null!=o&&(document.cookie=e+"="+o+";expires="+t.toGMTString())},clearCookie:function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;expires="+new Date(0).toUTCString()},getToken:function(){var e={};return null!==o.getCookie("token")?(e.token=o.getCookie("token"),e.uid=o.getCookie("uid"),e.username=o.getCookie("username")):Showbo.Msg.confirm("token已过期，请重新登录！",function(e){e&&(window.location.href="login.html")}),e},showBox:function(e){Showbo.Msg.alert(e)},confirmBox:function(e){Showbo.Msg.confirm(e,function(e){e&&(window.location.href="login.html")})}};t.default=o}]);