!function(e){function t(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var o={};t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";var n=o(1),i=function(e){return e&&e.__esModule?e:{default:e}}(n);i.default.namespace("PT.Signin"),PT.Signin=function(){this.lock=!1,this.http=i.default.http(),this.init(),this.bindEvent()},PT.Signin.prototype={init:function(){var e=this;$("#login").click(function(){e.validate()&&e.sendSignin()}),$(window).keypress(function(e){13==e.which&&($("#login").click(),e.preventDefault())})},bindEvent:function(){for(var e=$("#username"),t=$("#password"),o=0;o<e.length;o++)!function(t){$(e[o]).keyup(function(){0==$(this).val().length?$(this).siblings(".tip").hide():$(this).siblings(".tip").show()}),$(e[o]).keydown(function(){0==$(this).val().length?$(this).siblings(".tip").hide():$(this).siblings(".tip").show()})}();for(var n=0;n<t.length;n++)!function(e){$(t[n]).keyup(function(){0==$(this).val().length?$(this).siblings(".tip").hide():$(this).siblings(".tip").show()})}();t.keyup(function(){this.value=this.value.replace(/[^\w\.\/]/gi,"")})},validPw:function(e){var t=!0;return null==e.val()||""==e.val()||0==e.val().length?(t=!1,$("#pw").text("请输入登录密码"),$("#pw").show()):i.default.fChkPassword(e.val())?t=!0:(t=!1,$("#pw").text("密码长度应为8-16个字符的英文字母和数字"),$("#pw").show()),t},validUser:function(e){var t=!0;return null==e.val()||""==e.val()||0==e.val().length?(t=!1,$("#pw").text("请输入手机号/邮箱地址"),$("#pw").show()):i.default.fChkMail(e.val())||i.default.isphone(e.val())||(t=!1,$("#pw").text("手机号/邮箱输入格式错误"),$("#pw").show()),t},asyncUnit:function(e){var t=this,o=!0,n={},a="",l="";return i.default.isphone(e.val())?(n={mobile:e.val()},a="cloud.oauth.mobile.check",l=t.http.server+"?mobile="+n.mobile+"&method="+a):i.default.fChkMail(e.val())&&(n={email:e.val()},a="cloud.oauth.email.check",l=t.http.server+"?email="+n.email+"&method="+a),$.ajax({type:"get",url:l,headers:{method:a,appid:t.http.appid,sign:i.default.getSign(JSON.stringify(n),t.http.secretkey),timestramp:Date.parse(new Date)/1e3},cache:!1,async:!1,success:function(e){0==e.error_code?($("#pw").text("该账户不存在，请先注册账户"),$("#pw").show(),o=!1):($("#pw").hide(),o=!0)},error:function(e,t,o){}}),o},validate:function(){var e=this,t=!0,o=$("#username"),n=$("#password");return function(){var n=e.validUser(o);t=t&&n}(),function(){var o=e.validPw(n);t=t&&o}(),t},sendSignin:function(){var e=this,t=$("#username"),o=$("#password"),n={},a="";i.default.fChkMail(t.val())?(n={email:t.val(),password:o.val()},a="cloud.oauth.email.login"):i.default.isphone(t.val())&&(n={mobile:t.val(),password:o.val()},a="cloud.oauth.mobile.login"),$.ajax({type:"post",url:e.http.server,headers:{method:a,appid:e.http.appid,sign:i.default.getSign(JSON.stringify(n),e.http.secretkey),timestramp:Date.parse(new Date)/1e3},data:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:function(){var e=$('<div class="loadingMask"></div>');$('<div class="loadEffect"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div>').appendTo(e),e.appendTo("body")},complete:function(){$(".loadingMask").remove()},cache:!1,success:function(t){0==t.error_code?($("#pw").hide(),e.setWeek(t)):61001==t.error_code?($("#pw").text("用户已存在"),$("#pw").show()):($("#pw").text(t.msg),$("#pw").show())},error:function(e,t,o){}})},setWeek:function(e){i.default.clearCookie(),1==$("#login_selected")[0].checked?(i.default.setCookie("token",e.token,"d7"),i.default.setCookie("uid",e.uid,"d7"),i.default.setCookie("username",$("#username").val(),"d7")):(i.default.setCookie("token",e.token,"h8"),i.default.setCookie("uid",e.uid,"h8"),i.default.setCookie("username",$("#username").val(),"h8")),window.location.href="index.html"},active:function(e){$("#"+e).siblings(".error").hide()}},$(document).ready(function(){var e=decodeURI(i.default.getUrlParameter("service")),t=decodeURI(i.default.getUrlParameter("callback"));"undefined"!==e&&"undefined"!==t&&null!==i.default.getCookie("token")&&(window.location.href=t+"?token="+i.default.getCookie("token")+"&uid="+i.default.getCookie("uid")),new PT.Signin})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={http:function(){return{server:"https://api-open.putao.com/",appid:"1018043273668494336",secretkey:"07E13AFF126A4CAFBE58171AAB1CEE51"}},getSign:function(e,t){return hex_sha1(hex_md5(e).toLowerCase()+t).toLowerCase()},namespace:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var n,i,a,l,s,r,c,u,h;for(n=t,u=n.length,r=0;r<u;r++)for(s=n[r].split("."),l=window[s[0]]=window[s[0]]||{},a=s.slice(1),h=a.length,c=0;c<h;c++)i=a[c],l=l[i]=l[i]||{}},isphone:function(e){return/^1[0-9]{10}$/.test(e)},fChkMail:function(e){return/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,5}$/.test(e)},fChkPassword:function(e){return/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/.test(e)},dateFormat:function(e){var t=e.getFullYear()+"/";return e.getMonth()+1<10&&(t+="0"),t+=e.getMonth()+1+"/",e.getDate()<10&&(t+="0"),t+=e.getDate()+" ",e.getHours()<10&&(t+="0"),t+=e.getHours()+":",e.getMinutes()<10&&(t+="0"),t+=e.getMinutes()},goEail:function(e,t){var o=document.getElementById(t),n=e.split("@")[1];n=n.toLowerCase();var i={"qq.com":"http://mail.qq.com","gmail.com":"http://mail.google.com","sina.com":"http://mail.sina.com.cn","163.com":"http://mail.163.com","126.com":"http://mail.126.com","yeah.net":"http://www.yeah.net/","sohu.com":"http://mail.sohu.com/","tom.com":"http://mail.tom.com/","sogou.com":"http://mail.sogou.com/","139.com":"http://mail.10086.cn/","hotmail.com":"http://www.hotmail.com","live.com":"http://login.live.com/","live.cn":"http://login.live.cn/","live.com.cn":"http://login.live.com.cn","189.com":"http://webmail16.189.cn/webmail/","yahoo.com.cn":"http://mail.cn.yahoo.com/","yahoo.cn":"http://mail.cn.yahoo.com/","eyou.com":"http://www.eyou.com/","21cn.com":"http://mail.21cn.com/","188.com":"http://www.188.com/","foxmail.com":"http://www.foxmail.com"};for(var a in i)o.href=i[n]?i[n]:"http://mail."+i[n]},progress:function(e,t){var o=document.getElementById(e);100==t?$("#"+e).hide():$("#"+e).show();var n=o.width/2,i=o.height/2,t=t;if(o.getContext){var a=o.getContext("2d");a.beginPath(),a.moveTo(n,i),a.arc(n,i,60,0,2*Math.PI,!1),a.closePath(),a.fillStyle="#f3f3f3",a.fill(),a.beginPath(),a.moveTo(n,i),a.lineWidth=10,a.arc(n,i,60,1.5*Math.PI,1.5*Math.PI-2*Math.PI*t/100,!0),a.closePath(),a.fillStyle="#8C61DA",a.fill(),a.beginPath(),a.moveTo(n,i),a.arc(n,i,54.4,0,2*Math.PI,!0),a.closePath(),a.fillStyle="#ffffff",a.fill(),a.font="bold 9pt Arial",a.fillStyle="#8C61DA",a.textAlign="center",a.textBaseline="middle",a.moveTo(n,i),a.fillText(t+"%",n,i)}},getUrlParameter:function(e){var t,o,n,i=window.location.search.substring(1);if(i)for(t=i.split("&"),o=0;o<t.length;o++)if(n=t[o].split("="),n[0]===e)return n[1]},setCookie:function(e,t,n){var i=o.getsec(n),a=new Date;a.setTime(a.getTime()+1*i),document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()},getsec:function(e){var t=1*e.substring(1,e.length),o=e.substring(0,1);return"s"==o?1e3*t:"h"==o?60*t*60*1e3:"d"==o?24*t*60*60*1e3:void 0},getCookie:function(e){var t,o=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(o))?unescape(t[2]):null},delCookie:function(e){var t=new Date;t.setTime(t.getTime()-1);var o=getCookie(e);null!=o&&(document.cookie=e+"="+o+";expires="+t.toGMTString())},clearCookie:function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;expires="+new Date(0).toUTCString()},getToken:function(){var e={};return null!==o.getCookie("token")?(e.token=o.getCookie("token"),e.uid=o.getCookie("uid"),e.username=o.getCookie("username")):Showbo.Msg.confirm("token已过期，请重新登录！",function(e){e&&(window.location.href="login.html")}),e},showBox:function(e){Showbo.Msg.alert(e)},confirmBox:function(e){Showbo.Msg.confirm(e,function(e){e&&(window.location.href="login.html")})}};t.default=o}]);